# APPNICENAME=NFS
# APPDESCRIPTION=Access media directories and Docker config over NFS
services:
  nfs:
    container_name: nfs
    hostname: ${DOCKERHOSTNAME}
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-file: ${DOCKERLOGGING_MAXFILE}
        max-size: ${DOCKERLOGGING_MAXSIZE}
    privileged: true
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /lib/modules:/lib/modules:ro
      - ${DOCKERCONFDIR}:/media/configs
      - ${DOCKERSHAREDDIR}:/media/shared
      - ${DOWNLOADSDIR}:/media/downloads
      - ${MEDIADIR_AUDIOBOOKS}:/media/audiobooks
      - ${MEDIADIR_BOOKS}:/media/books
      - ${MEDIADIR_COMICS}:/media/comics
      - ${MEDIADIR_MOVIES}:/media/movies
      - ${MEDIADIR_MUSIC}:/media/music
      - ${MEDIADIR_TV}:/media/tv
    environment:
      - TZ=${TZ}
      - NFS_DISABLE_VERSION_3=1
      - NFS_EXPORT_1=/media ${NFS_IP_NETWORKS}(fsid=0,${NFS_OPTIONS})
      - NFS_EXPORT_2=/media/audiobooks ${NFS_IP_NETWORKS}(fsid=1,${NFS_OPTIONS})
      - NFS_EXPORT_3=/media/books ${NFS_IP_NETWORKS}(fsid=2,${NFS_OPTIONS})
      - NFS_EXPORT_4=/media/comics ${NFS_IP_NETWORKS}(fsid=3,${NFS_OPTIONS})
      - NFS_EXPORT_5=/media/configs ${NFS_IP_NETWORKS}(fsid=4,${NFS_OPTIONS})
      - NFS_EXPORT_6=/media/downloads ${NFS_IP_NETWORKS}(fsid=5,${NFS_OPTIONS})
      - NFS_EXPORT_7=/media/movies ${NFS_IP_NETWORKS}(fsid=6,${NFS_OPTIONS})
      - NFS_EXPORT_8=/media/music ${NFS_IP_NETWORKS}(fsid=7,${NFS_OPTIONS})
      - NFS_EXPORT_9=/media/shared ${NFS_IP_NETWORKS}(fsid=8,${NFS_OPTIONS})
      - NFS_EXPORT_10=/media/tv ${NFS_IP_NETWORKS}(fsid=9,${NFS_OPTIONS})
    cap_add:
      - SYS_MODULE

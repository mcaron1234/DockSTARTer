# APPNICENAME=NFS
# APPDESCRIPTION=Access media directories and Docker config over NFS
services:
  nfs:
    container_name: nfs
    hostname: ${DOCKERHOSTNAME}
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-file: ${DOCKERLOGGING_MAXFILE}
        max-size: ${DOCKERLOGGING_MAXSIZE}
    privileged: true
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /lib/modules:/lib/modules:ro
      - ${DOCKERCONFDIR}:/nfs/configs
      - ${DOCKERSHAREDDIR}:/nfs/shared
      - ${DOWNLOADSDIR}:/nfs/downloads
      - ${MEDIADIR_AUDIOBOOKS}:/nfs/audiobooks
      - ${MEDIADIR_BOOKS}:/nfs/books
      - ${MEDIADIR_COMICS}:/nfs/comics
      - ${MEDIADIR_MOVIES}:/nfs/movies
      - ${MEDIADIR_MUSIC}:/nfs/music
      - ${MEDIADIR_TV}:/nfs/tv
    environment:
      - TZ=${TZ}
      - NFS_DISABLE_VERSION_3=1
      - NFS_EXPORT_1=/nfs ${NFS_IP_NETWORKS}(fsid=0,${NFS_OPTIONS})
      - NFS_EXPORT_2=/nfs/audiobooks ${NFS_IP_NETWORKS}(fsid=1,${NFS_OPTIONS})
      - NFS_EXPORT_3=/nfs/books ${NFS_IP_NETWORKS}(fsid=2,${NFS_OPTIONS})
      - NFS_EXPORT_4=/nfs/comics ${NFS_IP_NETWORKS}(fsid=3,${NFS_OPTIONS})
      - NFS_EXPORT_5=/nfs/configs ${NFS_IP_NETWORKS}(fsid=4,${NFS_OPTIONS})
      - NFS_EXPORT_6=/nfs/downloads ${NFS_IP_NETWORKS}(fsid=5,${NFS_OPTIONS})
      - NFS_EXPORT_7=/nfs/movies ${NFS_IP_NETWORKS}(fsid=6,${NFS_OPTIONS})
      - NFS_EXPORT_8=/nfs/music ${NFS_IP_NETWORKS}(fsid=7,${NFS_OPTIONS})
      - NFS_EXPORT_9=/nfs/shared ${NFS_IP_NETWORKS}(fsid=8,${NFS_OPTIONS})
      - NFS_EXPORT_10=/nfs/tv ${NFS_IP_NETWORKS}(fsid=9,${NFS_OPTIONS})
    cap_add:
      - SYS_MODULE
